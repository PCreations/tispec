<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TiSpec</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="lib/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="stylesheets/tispec.css" rel="stylesheet">

    <script type="text/javascript" src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="javascripts/jquery-2.0.0.min.js"></script>
    <script type="text/javascript">
      var specs = [];

      function updateDescription(spec) {
        $('#spec_description').text(spec.suiteName + ' ' + spec.description);
        $('#sub_specs_results').find("tr:gt(0)").remove();

        if (!spec.passed) {
          var subSpecs = spec.subSpecs || [];
          for (var i = 0, l = subSpecs.length; i < l; i += 1) {
            var subSpec = subSpecs[i];
            if (!subSpec.passed_) {
              var row = '<tr><td>' + (i+1) + '</td><td>' + subSpec.expected + '</td><td>' + subSpec.actual + '</td></tr>';
              $('#sub_specs_results > tbody:last').append(row);
            }
          }
        } else {
          $('#sub_specs_results > tbody:last').append('<tr><td colspan="3"></td></tr>');
        }
      }
      function updateDescriptionById(id) {
        var spec = specs[id];
        updateDescription(spec);
      }

      function appendSpecResult(spec) {
        var row = '<tr class="spec_row ' + (spec.passed ? 'success' : 'error') + '"><td>' + spec.suiteName + ' ' + spec.description + '</td><td>' + spec.passedCount + '/' + spec.totalCount + ' passed</td><td><a href="#" class="btn btn-small btn-info" onclick="updateDescriptionById(' + (specs.length + 0) + '); return false;">Results</a></td></tr>';
        $('#specs_results > tbody:last').append(row);
        updateDescription(spec);
        specs.push(spec);
      }

      function appendSuiteStart(suite) {
        $('#specs_results > tbody:last').append('<tr><td>' + suite.description + '</td><td colspan="2">' + suite.passedCount + '/' + suite.totalCount + ' passed</td></tr>');
      }

    </script>
  </head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Main Content
    ================================================== -->
    <div class="container">

      <div class="row">

        <!-- Left Part
        ================================================== -->
        <div class="span6" id="left_body">
          <div>
            <form class="form-inline" method="GET" action="/specs">
              <div class="input-append">
                <input type="text" name="filter" class="input-xlarge" placeholder="Filter" value="<%= filter || '' %>">
                <button type="submit" class="btn">Execute</button>
              </div>
            </form>
          </div>
          <div>
            <table class="table table-hover table-condensed" id="specs_results">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </div>
        </div> <!-- Left Part -->

        <!-- Right Part
        ================================================== -->
        <div class="span5 offset7" id="right_body" style="position: fixed;">
          <h2 id="spec_description"></h2>

          <h3>Errors</h3>
          <div>
            <table class="table table-hover table-condensed" id="sub_specs_results">
              <thead>
                <tr>
                  <th>Id</th>
                  <th>Expected</th>
                  <th>Got</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </div>
        </div> <!-- Right Part -->

      </div> <!-- row -->
    </div> <!-- container -->
